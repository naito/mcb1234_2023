# SOL_基礎分子生物学
 automation tools for SOL LMS

## 教科書テストバンクのWordファイルの問題をSOLの問題バンクにコピーする
### テストバンクのWordファイルをhtmlに変換 
* docxファイルを修正した場合は、別名で保存、ファイル形式『Webページ (フィルター後) (.htm)』を選択し、ファイル名はPythonファイル内の設定通りにつける。

### 問題の段落構成
#### MSA Multiple Short Answers Question 複数の短答問題からなる
* 冒頭は p.Q
* 問題文が終わり、選択肢列挙がはじまると p.QS
	* p.FIGN などが入った場合、直前の p.QS と同じ選択肢と判断
	* 選択肢ブロックに入ると p.Q は登場しないはずだが、選択肢の後に問題文がある場合があり、エラーになるので、現状、マニュアルで修正（段落を p.QS の上に移す）
	* 選択肢 1〜 のあとに、その組み合わせを選択肢 A〜 から選ばせる形式の問題は、選択肢 1〜 の class をマニュアルで p.QS から p.Q に書き換える。

### テストバンクのhtmlを読み込んで、SOLのQuizに変換  
* 変換対象の章番号を、`ECB5のtestbankからSOLにQuizを作成.py` 内の変数 `CHAPTERS` に書き込んで保存。
* 実行。
* エラーが出たらhtmlファイルの内容を点検して修正する。
	* エラーの多くは段落（p）のclass設定が不適切なことに起因する。
* 正常に終了すると、SOLのQuizに`ECB-05-TFQ`などのQuizができている。

### QuizをQuestionBankにコピー
* Canvas APIには問題バンクを操作する関数が用意されていないので、問題バンクが絡む操作はSeleniumを用いたブラウザの自動運転で行う。
* SOLにコピー先の問題バンクをつくる。
* コピー元のクイズIDとコピー先の問題バンクIDを `科目クイズを問題バンクに移動.py`  内の変数 `from_to_list` に に書き込んで保存。
* 実行。
	* 動作確認できるようにヘッドレス実行にはしていない。頻回に行う作業ではなく、作業結果にミスが含まれる場合、成績評価などにクリティカルな影響がでる可能性があるので、動作速度より確実性を重視。
	* コピー元（Quiz）は、Seleniumではなく、canvasapiで操作することも可能だが、コピー先にペーストされるデータとの同一性が簡単に担保できるためSeleniumを用いている。

## Quizレポートを作成して、csvファイルに保存する

* `Quizレポートを作成してダウンロード.py` に以下の変数を書き込んで保存する。
	* 科目ID： `COURSE_ID`
	* 作成対象のQuiz ID： `Quiz_ids`
	* ダウンロードしたファイルを保存するフォルダ： `DIST_PATH`
* 実行。
* Googleスプレッドシートにインポート
